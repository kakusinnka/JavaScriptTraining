<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TEST0006</title>
    <script src="./test0006.js"></script>
</head>

<body>
    <!-- 使用方法做为事件处理程序 -->
    <!-- <input type="text" onkeyup="HD.show()" />
    <script>
        class HD {
            static show() {
                console.log('houdunren')
            }
        }
    </script> -->

    <!-- 传递事件源对象与事件对象 -->
    <!-- <button onclick="show(this,'houdunren','hdcms','向军大叔',event)">后盾人</button>
    <script>
        // 剩余参数语法允许我们将一个不定数量的参数表示为一个数组
        function show(...args) {
            console.log(args)
        }
    </script> -->

    <!-- 使用addEventListener来多个事件处理程序 -->
    <!-- <div id="app">houdunren.com</div>
    <script>
        const app = document.querySelector('#app')
        app.addEventListener('click', function () {
            this.style.color = 'red'
        })
        app.addEventListener('click', function () {
            this.style.fontSize = '55px'
        })
    </script> -->

    <!-- 通过对象绑定 -->
    <!-- <div id="app">houdunren.com</div>
    <script>
        const app = document.querySelector('#app')
        class HD {
            handleEvent(e) {
                this[e.type](e)
            }
            click() {
                console.log('单击事件')
            }
            mouseover() {
                console.log('鼠标移动事件')
            }
        }
        app.addEventListener('click', new HD())
        app.addEventListener('mouseover', new HD())
    </script> -->

    <!-- 使用once:true 来指定事件只执行一次 -->
    <!-- <button id="app">houdunren.com</button>
    <script>
        const app = document.querySelector('#app')
        app.addEventListener(
            'click',
            function () {
                alert('houdunren@向军大叔')
            },
            { once: true }
        )
    </script> -->

    <!-- 设置 { capture: true } 或直接设置第三个参数为true用来在捕获阶段执行事件 -->
    <!-- addEventListener的第三个参数传递true/false 和设置 {capture:true/false}是一样 -->
    <!-- <div id="app" style="background-color: red">
        <button id="bt">houdunren.com</button>
    </div>
    <script>
        const app = document.querySelector('#app')
        const bt = document.querySelector('#bt')
        app.addEventListener(
            'click',
            function () {
                alert('这是div事件 ')
            },
            { capture: true }
        )

        bt.addEventListener(
            'click',
            function () {
                alert('这是按钮事件 ')
            },
            { capture: true }
        )
    </script> -->

    <!-- 设置 { capture: false } 或直接设置第三个参数为false用来在冒泡阶段执行事件 -->
    <!-- <div id="app" style="background-color: red">
        <button id="bt">houdunren.com</button>
    </div>
    <script>
        const app = document.querySelector('#app')
        const bt = document.querySelector('#bt')
        app.addEventListener(
            'click',
            function () {
                alert('这是div事件 ')
            },
            { capture: false }
        )

        bt.addEventListener(
            'click',
            function () {
                alert('这是按钮事件 ')
            },
            { capture: false }
        )
    </script> -->

    <!-- 冒泡行为 -->
    <!-- <style>
        #app {
            background: #34495e;
            width: 300px;
            padding: 30px;
        }

        #app h2 {
            background-color: #f1c40f;
            margin-right: -100px;
        }
    </style>
    <div id="app">
        <h2>houdunren.com</h2>
    </div>
    <script>
        const app = document.querySelector('#app')
        const h2 = document.querySelector('h2')
        app.addEventListener('click', (event) => {
            // 
            console.log(`event.currentTarget:${event.currentTarget.nodeName}`)
            //   event.target 可以在事件链中最底层的定义事件的对象
            console.log(`event.target:${event.target.nodeName}`)
            console.log('app event')
        })
        h2.addEventListener('click', () => {
            // event.currentTarget == this 即当前执行事件的对象
            console.log(`event.currentTarget:${event.currentTarget.nodeName}`)
            //   event.target 可以在事件链中最底层的定义事件的对象
            console.log(`event.target:${event.target.nodeName}`)
            console.log(`h2 event`)
        })
    </script> -->

    <!-- 阻止冒泡 -->
    <!-- <style>
        #app {
            background: #34495e;
            width: 300px;
            padding: 30px;
        }

        #app h2 {
            background-color: #f1c40f;
            margin-right: -100px;
        }
    </style>
    <div id="app">
        <h2>houdunren.com</h2>
    </div>
    <script>
        const app = document.querySelector('#app')
        const h2 = document.querySelector('h2')
        app.addEventListener('click', (event) => {
            console.log(`event.currentTarget:${event.currentTarget.nodeName}`)
            console.log(`event.target:${event.target.nodeName}`)
            console.log('app event')
        })
        h2.addEventListener('click', (event) => {
            // event.stopPropagation() 用于阻止冒泡
            // event.stopPropagation()
            // event.stopImmediatePropagation() 阻止事件冒泡并且阻止相同事件的其他事件处理程序被调用
            event.stopImmediatePropagation()
            console.log(`event.currentTarget:${event.currentTarget.nodeName}`)
            console.log(`event.target:${event.target.nodeName}`)
            console.log(`h2 event`)
        })
        h2.addEventListener('click', (event) => {
            console.log('h2 的第二个事件处理程序')
        })
    </script> -->

    <!-- 事件捕获 -->
    <!-- 事件执行顺序为 捕获 > 事件目标 > 冒泡，在向下传递到目标对象的过程即为事件捕获。事件捕获在实际使用中频率不高。 -->
    <!-- <style>
        #app {
            background: #34495e;
            width: 300px;
            padding: 30px;
        }

        #app h2 {
            background-color: #f1c40f;
            margin-right: -100px;
        }
    </style>
    <div id="app">
        <h2>houdunren.com</h2>
    </div>
    <script>
        const app = document.querySelector('#app')
        const h2 = document.querySelector('h2')
        app.addEventListener(
            'click',
            (event) => {
                console.log('app event')
            },
            { capture: true }
        )
        h2.addEventListener('click', (event) => {
            console.log(`h2 event`)
        })
    </script> -->

    <!-- 事件代理 -->
    <!-- 为父级UL设置事件来控制子元素LI的样式切换 -->
    <!-- <style>
        .hd {
            border: solid 2px #ddd;
            background-color: red;
            color: white;
        }
    </style>
    <ul>
        <li>houdunren.com</li>
        <li>hdcms.com</li>
    </ul>

    <script>
        'use strict'
        const ul = document.querySelector('ul')
        ul.addEventListener('click', () => {
            // toggle()从列表中删除一个给定的标记 并返回 false 。 如果标记 不存在，则添加并且函数返回 true。
            if (event.target.tagName === 'LI') event.target.classList.toggle('hd')
        })
    </script> -->

    <!-- 使用事件代理来共享事件处理程序，不用为每个元素单独绑定事件 -->
    <!-- <ul>
        <li data-action="hidden">houdunren.com</li>
        <li data-action="color" data-color="red">hdcms.com</li>
    </ul>
    <script>
        class HD {
            constructor(el) {
                el.addEventListener('click', (e) => {
                    const action = e.target.dataset.action
                    this[action](e)
                })
            }
            hidden() {
                event.target.hidden = true
            }
            color() {
                event.target.style.color = event.target.dataset.color
            }
        }
        new HD(document.querySelector('ul'))
    </script> -->

    <!-- 下面是使用事件代理实现的TAB面板效果 -->
    <!-- <div class="tab">
        <dl>
            <dt data-action="toggle">在线教程</dt>
            <dd data-action="hidden">houdunren.com</dd>
        </dl>
        <dl>
            <dt data-action="toggle">开源软件</dt>
            <dd data-action="hidden">hdcms.com</dd>
        </dl>
    </div>

    <script>
        class HD {
            constructor(el) {
                this.el = el
                // bind() 方法创建一个新的函数，在 bind() 被调用时，这个新函数的 this 被指定为 bind() 的第一个参数，而其余参数将作为新函数的参数，供调用时使用。
                el.addEventListener('click', this.handle.bind(this))
            }
            handle() {
                const action = event.target.dataset.action
                if (action) this[action]()
            }
            hidden() {
                event.target.hidden = true
            }
            toggle() {
                this.el.querySelectorAll(`[data-action='hidden']`).forEach((e) => (e.hidden = true))
                event.target.nextElementSibling.hidden = ''
            }
        }
        new HD(document.querySelector('.tab'))
    </script> -->

    <!-- 下面实现通过代理事件行为，在表单提交时禁用提交按钮，并记录提示次数 -->
    <!-- <form>
        <input type="text" />
        <button type="button" data-submit-disabled data-action="submit,counter">提交表单</button>
    </form>
    <script>
        class FORM {
            constructor(form) {
                this.form = form
                this.form.counter = 0
                this.form.addEventListener('click', this.handle.bind(this))
            }
            handle() {
                const actions = event.target.dataset.action
                actions.split(',').forEach((action) => {
                    if (this[action]) this[action]()
                })
            }
            submit() {
                event.preventDefault()
                this.disableButton(true)
                console.log('提交中')
                setTimeout(() => {
                    this.disableButton(false)
                    console.log('提交结束')
                }, 1000)
            }
            disableButton(state) {
                this.form.querySelectorAll(`[data-submit-disabled]`).forEach((bt) => {
                    bt.disabled = state
                })
            }
            counter() {
                this.form.counter++
                console.log(this.form.counter)
            }
        }
        document.querySelectorAll(`form`).forEach((form) => {
            new FORM(form)
        })
    </script> -->

    <!-- 下面使用事件代理来对未来元素进行事件绑定 -->
    <!-- <div id="app">
        <h2>houdunren.com</h2>
    </div>

    <script>
        function show() {
            console.log(this.textContent)
        }
        const app = document.querySelector('#app')
        const h2 = document.querySelectorAll('h2')
        app.addEventListener('click', () => {
            // call() 方法使用一个指定的 this 值和单独给出的一个或多个参数来调用一个函数。
            show.call(event.target)
        })
        let newH2 = document.createElement('h2')
        newH2.textContent = 'hdcms.com'
        app.append(newH2)
    </script> -->

    <!-- 阻止超链接的默认行为 -->
    <a href="https://www.houdunren.com">后盾人</a>
    <script>
        document.querySelector('a').addEventListener('click', () => {
            event.preventDefault()
            alert(event.target.innerText)
        })
    </script>
</body>

</html>